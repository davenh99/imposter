import{u as k,k as G,a as C,c as g,o as W,b as R,t as s,i,m as U,d as I}from"./index-DZ9f14vb.js";import{g as L,G as P,a as j}from"./api-CPuXkLTF.js";var N=s('<div class="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 flex items-center justify-center p-4"><div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-800 mb-2">Game'),T=s('<div class="text-center text-gray-500 py-8"><p>Loading game...'),E=s('<div class=text-center><div class="text-6xl font-bold text-yellow-600 mb-4">ðŸ‘‘</div><h3 class="text-2xl font-bold text-gray-800 mb-4">Game In Progress</h3><p class="text-gray-600 mb-8">The players are playing. The imposter is trying to guess the word.'),H=s('<div class=text-center><div class="text-6xl font-bold text-red-600 mb-4">ðŸŽ­</div><h3 class="text-2xl font-bold text-gray-800 mb-4">You are the Imposter!</h3><p class="text-gray-600 mb-8">Your goal is to figure out what the word is by asking questions and listening to the other players.'),J=s(`<div class=text-center><div class="text-6xl font-bold text-green-600 mb-4">âœ“</div><h3 class="text-xl font-bold text-gray-800 mb-4">The Word Is:</h3><div class="bg-gradient-to-r from-blue-100 to-purple-100 rounded-lg p-8 mb-8"><p class="text-4xl font-bold text-blue-600"></p></div><p class=text-gray-600>Don't let the imposter figure this out!`);function q(){const b=k(),p=G(),l=C(),c=b.code,d=new URLSearchParams(p.search).get("name")||"Player",u=d==="Host",[m,x]=g(null),[f,h]=g(null),y=L();let o=null;function v(){return j(`/api/v1/ws/${c}`)}function w(){l("/")}return W(async()=>{try{if(!(await fetch(`${y}/api/v1/lobbies/${c}`)).ok){console.error("Lobby not found, redirecting to home"),l("/");return}}catch(t){console.error("Error checking lobby:",t),l("/");return}o=new WebSocket(v()),o.onopen=()=>{console.log("GameRoom WebSocket opened, sending join message"),o?.send(JSON.stringify({type:"join",name:d}))},o.onmessage=t=>{try{const e=JSON.parse(t.data);console.log("GameRoom received message:",e),e.type==="game_started"&&(console.log("Game started, role:",e.role,"word:",e.word),x(e.role),e.role==="word"&&h(e.word)),e.type==="lobby_state"&&console.log("Ignoring lobby_state in game room")}catch(e){console.error("WebSocket message error:",e)}},o.onerror=t=>{console.error("WebSocket error in GameRoom:",t)},o.onclose=()=>{console.log("WebSocket closed in GameRoom")}}),R(()=>{o&&o.close()}),(()=>{var t=N(),e=t.firstChild;return e.firstChild,i(e,(()=>{var _=U(()=>m()===null);return()=>_()?T():u?(()=>{var r=E(),n=r.firstChild,a=n.nextSibling;return a.nextSibling,i(r,I(P,{onClick:w,class:"w-full bg-red-600 hover:bg-red-700",children:"End Game"}),null),r})():m()==="imposter"?H():(()=>{var r=J(),n=r.firstChild,a=n.nextSibling,$=a.nextSibling,S=$.firstChild;return i(S,f),r})()})(),null),t})()}export{q as default};
