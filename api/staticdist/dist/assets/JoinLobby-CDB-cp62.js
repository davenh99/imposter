import{u as P,k as j,a as J,c as m,o as G,b as N,t as l,i as o,m as R,d as I}from"./index-BTLCJJPZ.js";import{g as O,G as A,a as B}from"./api-C1UlGYdT.js";var E=l('<div class="min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 flex items-center justify-center p-4"><div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-800 mb-2">Joined Lobby</h2><p class="text-gray-500 text-sm">Waiting for the host to start the game...</p></div><div class="bg-gray-100 rounded-lg p-6 mb-6"><p class="text-gray-600 text-sm mb-2">Lobby Code:</p><p class="text-3xl font-bold text-purple-600 text-center tracking-wider"></p></div><div class=mb-6><p class="text-gray-700 font-semibold mb-3">Players in lobby: <span class=text-purple-600></span></p><div class="space-y-2 min-h-12"></div></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"><p class="text-blue-700 text-sm">âœ“ Successfully joined the lobby. Waiting for the game to start...'),M=l('<span class="text-gray-400 text-sm">Connecting...'),q=l('<span class="inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium mr-2">');function F(){const u=P(),y=j(),n=J(),r=u.code,i=new URLSearchParams(y.search).get("name")||"Player",[a,f]=m([]),[c,x]=m(!1),v=O();let e=null;function h(){return B(`/api/v1/ws/${r}`)}function $(){x(!0),e&&e.close(),n("/")}return G(async()=>{try{if(!(await fetch(`${v}/api/v1/lobbies/${r}`)).ok){console.error("Lobby not found, redirecting to home"),n("/");return}}catch(s){console.error("Error checking lobby:",s),n("/");return}e=new WebSocket(h()),e.onopen=()=>{console.log("WebSocket opened, sending join message"),e?.send(JSON.stringify({type:"join",name:i}))},e.onmessage=s=>{try{const t=JSON.parse(s.data);console.log("Received message:",t),t.type==="lobby_state"&&(console.log("Updating players:",t.players),f(t.players||[])),t.type==="game_started"&&(console.log("Game started, navigating to game room"),n(`/game/${r}?name=${encodeURIComponent(i)}`))}catch(t){console.error("WebSocket message error:",t)}},e.onerror=s=>{console.error("WebSocket error:",s)},e.onclose=()=>{console.log("WebSocket closed")}}),N(()=>{e&&e.close()}),(()=>{var s=E(),t=s.firstChild,_=t.firstChild,b=_.nextSibling,S=b.firstChild,k=S.nextSibling,g=b.nextSibling,p=g.firstChild,w=p.firstChild,L=w.nextSibling,C=p.nextSibling;return g.nextSibling,o(k,r),o(L,()=>a().length),o(C,(()=>{var W=R(()=>a().length===0);return()=>W()?M():a().map(U=>(()=>{var d=q();return o(d,U),d})())})()),o(t,I(A,{onClick:$,get disabled(){return c()},variant:"secondary",class:"w-full",get children(){return c()?"Leaving...":"Leave Lobby"}}),null),s})()}export{F as default};
