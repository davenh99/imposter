import{u as R,k as I,a as P,c as f,o as j,b as G,t as d,i as n,m as J,d as N}from"./index-O0OhPoee.js";import{g as A,G as B,a as E}from"./api-N5PQaMAh.js";var M=d('<div class="min-h-screen bg-cover bg-[url(/img/46840.jpg)] flex items-center justify-center p-4"><div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-800 mb-2">Joined Lobby</h2><p class="text-gray-500 text-sm">Waiting for the host to start the game...</p></div><div class="bg-gray-100 rounded-lg p-6 mb-6"><p class="text-gray-600 text-sm mb-2">Lobby Code:</p><p class="text-3xl font-bold text-purple-600 text-center tracking-wider"></p></div><div class=mb-6><p class="text-gray-700 font-semibold mb-3">Players in lobby: <span class=text-purple-600></span></p><div class="space-y-2 min-h-12"></div></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"><p class="text-blue-700 text-sm">âœ“ Successfully joined the lobby. Waiting for the game to start...'),O=d('<span class="text-gray-400 text-sm">Connecting...'),q=d('<span class="inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium mr-2">');function F(){const y=R(),x=I(),l=P(),a=y.code,m=new URLSearchParams(x.search).get("name")||"Player",[c,v]=f([]),[b,h]=f(!1),$=A();let o=null;function _(){return E(`/api/v1/ws/${a}`)}function w(){h(!0),o&&o.close(),l("/")}return j(async()=>{try{if(!(await fetch(`${$}/api/v1/lobbies/${a}`)).ok){console.error("Lobby not found, redirecting to home"),l("/");return}}catch(t){console.error("Error checking lobby:",t),l("/");return}o=new WebSocket(_()+`?name=${encodeURIComponent(m)}`),o.onmessage=t=>{try{const e=JSON.parse(t.data);if(console.log("Received message:",e),e.type==="lobby_state"&&(console.log("Updating players:",e.players),v(e.players||[])),e.type==="game_started"){console.log("Game started, navigating to game room");const i=e.role?encodeURIComponent(e.role):null,s=e.word?encodeURIComponent(e.word):null;let r=`/game/${a}?name=${encodeURIComponent(m)}`;i&&(r+=`&role=${i}`),s&&(r+=`&word=${s}`),l(r)}}catch(e){console.error("WebSocket message error:",e)}},o.onerror=t=>{console.error("WebSocket error:",t)},o.onclose=()=>{console.log("WebSocket closed")}}),G(()=>{o&&o.close()}),(()=>{var t=M(),e=t.firstChild,i=e.firstChild,s=i.nextSibling,r=s.firstChild,S=r.nextSibling,g=s.nextSibling,p=g.firstChild,C=p.firstChild,L=C.nextSibling,k=p.nextSibling;return g.nextSibling,n(S,a),n(L,()=>c().length),n(k,(()=>{var U=J(()=>c().length===0);return()=>U()?O():c().map(W=>(()=>{var u=q();return n(u,W),u})())})()),n(e,N(B,{onClick:w,get disabled(){return b()},variant:"secondary",class:"w-full",get children(){return b()?"Leaving...":"Leave Lobby"}}),null),t})()}export{F as default};
