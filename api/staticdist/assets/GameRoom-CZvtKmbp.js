import{u as J,k as T,a as V,c as s,o as A,b as Y,t as c,i as r,d as u,g as q,s as z}from"./index-3ff5CIu3.js";import{g as F,G as f,a as K}from"./api-C2kMzMAA.js";var Q=c('<div class="min-h-screen bg-cover bg-[url(/img/46840.jpg)] flex items-center justify-center p-4"><div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-gray-800 mb-2">Game'),X=c('<div class=text-center><img alt=what class="mx-auto mb-4 w-50 h-50 rounded-lg"><h3 class="text-2xl font-bold text-gray-800 mb-4">Game In Progress</h3><p class="text-gray-600 mb-8">who da imposter à¶</p><div><h4>Does the word suck ?? ğŸ˜²</h4><div class="text-4xl font-bold text-blue-600 mb-4">/</div></div><div class="flex gap-3">'),Z=c('<div class="text-center text-gray-500 py-8"><p>Loading game...'),ee=c(`<div class=text-center><img src=/img/hamster.svg alt=Imposter class="mx-auto mb-4 w-50 h-50"><h3 class="text-2xl font-bold text-gray-800 mb-4">You are the Imposter!</h3><p class="text-gray-600 mb-8">Don't get found out!!!! ğŸ˜³`),te=c(`<div class=text-center><div class="text-6xl font-bold text-green-600 mb-4">âœ“</div><h3 class="text-xl font-bold text-gray-800 mb-4">The Word Is:</h3><div class="bg-gradient-to-r from-blue-100 to-purple-100 rounded-lg p-8 mb-8"><p class="text-4xl font-bold text-blue-600"></p></div><p class=text-gray-600>Don't let the imposter figure this out!</p><p class=pt-3>Does the word suck?</p><div class="flex gap-3 justify-center mt-4 w-full">`);const p=["/img/50_emoj.png","/img/aggressive-laugh.jpg","/img/booty.jpg","/img/shrek.jpeg","/img/skull-balenciaga.gif","/img/tounge.webp"];function ne(){const R=J(),h=T(),a=V(),n=R.code,x=new URLSearchParams(h.search).get("name")||"Player",w=x==="Host",P=new URLSearchParams(h.search).get("role"),j=new URLSearchParams(h.search).get("word"),[_,U]=s(P||null),[W,S]=s(j||null),v=F(),[I,N]=s(0),[E,H]=s(0),[k,C]=s(!1),[L,B]=s(p[Math.floor(Math.random()*p.length)]);let o=null;function M(){return K(`/api/v1/ws/${n}`)}function O(){fetch(`${v}/api/v1/lobbies/${n}/end`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error("failed to end game");a(`/lobby/${n}?name=Host`)}).catch(t=>{console.error("End game failed:",t),a(`/lobby/${n}?name=Host`)})}function D(){B(p[Math.floor(Math.random()*p.length)]),fetch(`${v}/api/v1/lobbies/${n}/restart`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error("failed to restart game");console.log("Game restarted")}).catch(t=>{console.error("Restart game failed:",t)})}return A(async()=>{try{if(!(await fetch(`${v}/api/v1/lobbies/${n}`)).ok){console.error("Lobby not found, redirecting to home"),a("/");return}}catch(t){console.error("Error checking lobby:",t),a("/");return}o=new WebSocket(M()+`?name=${encodeURIComponent(x)}`),o.onopen=()=>{console.log("GameRoom WebSocket opened, sending join message")},o.onmessage=t=>{try{const e=JSON.parse(t.data);if(console.log("GameRoom received message:",e),e.type==="word_vote_update"){const l=typeof e.count=="number"?e.count:Number(e.count||0);H(l);return}if(e.type==="game_ended"){console.log("Game ended, navigating back to lobby/join"),a(w?`/lobby/${n}?name=Host`:`/join/${n}?name=${encodeURIComponent(x)}`);return}if(e.type==="game_started"&&(console.log("Game started (or restarted), role:",e.role,"word:",e.word),U(e.role||null),e.word?S(e.word):S(null)),e.type==="lobby_state"){console.log("Updating player count from lobby_state in game room");const l=e.players||[];N(l.length||0)}}catch(e){console.error("WebSocket message error:",e)}},o.onerror=t=>{console.error("WebSocket error in GameRoom:",t)},o.onclose=()=>{console.log("WebSocket closed in GameRoom")}}),Y(()=>{o&&o.close()}),(()=>{var t=Q(),e=t.firstChild;return e.firstChild,r(e,()=>w?(()=>{var l=X(),d=l.firstChild,y=d.nextSibling,m=y.nextSibling,g=m.nextSibling,$=g.firstChild,i=$.nextSibling,b=i.firstChild,G=g.nextSibling;return r(i,E,b),r(i,()=>I()-1,null),r(G,u(f,{onClick:O,variant:"red",class:"flex-1",children:"End Game"}),null),r(G,u(f,{onClick:D,variant:"secondary",class:"flex-1",children:"New Game"}),null),q(()=>z(d,"src",L())),l})():_()===null?Z():_()==="imposter"?ee():(()=>{var l=te(),d=l.firstChild,y=d.nextSibling,m=y.nextSibling,g=m.firstChild,$=m.nextSibling,i=$.nextSibling,b=i.nextSibling;return r(g,W),r(b,u(f,{onClick:()=>{o&&o.send(JSON.stringify({type:"vote_bad",voted:!0})),C(!0)},variant:"red",get class(){return`flex-1 transition-all ${k()?"font-bold":"opacity-40"}`},children:"Hell yeah ğŸ‘"}),null),r(b,u(f,{onClick:()=>{o&&o.send(JSON.stringify({type:"vote_bad",voted:!1})),C(!1)},variant:"green",get class(){return`flex-1 transition-all ${k()?"opacity-40":"font-bold"}`},children:"Nah, it's ok ğŸ‘"}),null),l})(),null),t})()}export{ne as default};
